{"ast":null,"code":"var _jsxFileName = \"/Users/limzzum/ssafyProject/S09P31A501/frontend/src/pages/MatchingGamePage/index.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport \"./style.css\";\nimport React, { useEffect, useState } from \"react\";\n// Axios 추가\nimport { URL, serverUrl } from \"./constants/constants\";\nimport { Client } from \"@stomp/stompjs\";\nimport SockJS from \"sockjs-client\";\nimport { SocketType, waitingGame } from \"../../api/MatchingGameAPI/MatchingGameAPI\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = new SockJS(URL);\nconst stompClient = new Client({\n  webSocketFactory: () => socket\n});\nstompClient.activate();\nfunction MatchingGamePage() {\n  _s();\n  const [gameId, setGameId] = useState(null);\n  const [imageUrl, setImageUrl] = useState(\"\"); // 이미지 URL 상태\n\n  const messageToSend = {\n    socketType: SocketType.GAME_INFO,\n    message: \"hihi\"\n  };\n  useEffect(() => {\n    // 컴포넌트가 마운트될 때, 웹 소켓을 사용할 준비\n    stompClient.activate();\n    console.log(\"axios 요청 호출\");\n    waitingGame().then(response => {\n      console.log(response);\n      setGameId(response.data.data.gameId);\n      setImageUrl(serverUrl + \"/profiles/\" + response.data.data.profile);\n      console.log(\"url : \" + imageUrl);\n      console.log(response.data.data.profile);\n      console.log(`${serverUrl}/profiles/${response.data.data.profile}`);\n      // https://xn--vr-kg0j662g.site/profiles/2023/11/05/01c7b349-6bb2-4ae2-9d71-1b64370a280b-%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-08-25%20%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB%209.47.20.png\n      // 게임 아이디를 받아온 후, 웹 소켓을 초기화하고 구독합니다.\n      const subscription = subscribeToChatRoom(response.data.data.gameId);\n      return () => {\n        // 컴포넌트가 언마운트될 때 구독을 해제\n        subscription.unsubscribe();\n      };\n    }).catch(error => {\n      // 오류 처리\n    });\n    return () => {\n      // 컴포넌트가 언마운트될 때, 웹 소켓 연결 해제\n      stompClient.deactivate();\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"matching-game-container\",\n    children: [imageUrl && /*#__PURE__*/_jsxDEV(\"img\", {\n      src: imageUrl,\n      alt: \"Game Image\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 20\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"waiting-game-container\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n}\n_s(MatchingGamePage, \"UZuwF2EmFeR8pGZlhrV7i2OqL4U=\");\n_c = MatchingGamePage;\nfunction subscribeToChatRoom(gameId) {\n  return stompClient.subscribe(`/topic/game.${gameId}`, message => {\n    const receivedMessage = JSON.parse(message.body);\n    console.log(\"Received message:\", receivedMessage);\n  });\n}\nfunction publishMessageToChatRoom(gameId, message) {\n  stompClient.publish({\n    destination: `/pub/game.${gameId}`,\n    body: JSON.stringify(message)\n  });\n}\nfunction MatchingGameStart() {\n  _s2();\n  const [gameId, setGameId] = useState(null);\n  const messageToSend = {\n    socketType: SocketType.GAME_INFO,\n    message: \"hihi\"\n  };\n  useEffect(() => {\n    // 컴포넌트가 마운트될 때, 웹 소켓을 사용할 준비\n    stompClient.activate();\n    console.log(\"axios 요청 호출\");\n    waitingGame().then(response => {\n      console.log(response);\n      setGameId(response.data.data.gameId);\n\n      // 게임 아이디를 받아온 후, 웹 소켓을 초기화하고 구독합니다.\n      const subscription = subscribeToChatRoom(response.data.data.gameId);\n      return () => {\n        // 컴포넌트가 언마운트될 때 구독을 해제\n        subscription.unsubscribe();\n      };\n    }).catch(error => {\n      // 오류 처리\n    });\n    return () => {\n      // 컴포넌트가 언마운트될 때, 웹 소켓 연결 해제\n      stompClient.deactivate();\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"matching-game-container\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 146,\n    columnNumber: 10\n  }, this);\n}\n_s2(MatchingGameStart, \"voi8IuICPW1XfvcpSFpdlYbTa+g=\");\n_c2 = MatchingGameStart;\nexport { MatchingGamePage, MatchingGameStart };\nvar _c, _c2;\n$RefreshReg$(_c, \"MatchingGamePage\");\n$RefreshReg$(_c2, \"MatchingGameStart\");","map":{"version":3,"names":["React","useEffect","useState","URL","serverUrl","Client","SockJS","SocketType","waitingGame","jsxDEV","_jsxDEV","socket","stompClient","webSocketFactory","activate","MatchingGamePage","_s","gameId","setGameId","imageUrl","setImageUrl","messageToSend","socketType","GAME_INFO","message","console","log","then","response","data","profile","subscription","subscribeToChatRoom","unsubscribe","catch","error","deactivate","className","children","src","alt","fileName","_jsxFileName","lineNumber","columnNumber","_c","subscribe","receivedMessage","JSON","parse","body","publishMessageToChatRoom","publish","destination","stringify","MatchingGameStart","_s2","_c2","$RefreshReg$"],"sources":["/Users/limzzum/ssafyProject/S09P31A501/frontend/src/pages/MatchingGamePage/index.tsx"],"sourcesContent":["import \"./style.css\";\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\"; // Axios 추가\nimport { URL, serverUrl, localUrl } from \"./constants/constants\";\nimport { Client, Frame } from \"@stomp/stompjs\";\nimport SockJS from \"sockjs-client\";\nimport { config } from \"process\";\nimport {\n  SocketType,\n  waitingGame,\n} from \"../../api/MatchingGameAPI/MatchingGameAPI\";\n\ninterface receiveMessage {\n  socketType: SocketType;\n  gameStatus: GameStatus;\n  data: any;\n  message: string;\n}\n\ninterface sendMessage {\n  socketType: SocketType;\n  message: string;\n}\n\ninterface GameStatus {\n  gameId: number;\n  curRound: number;\n  playerA: Player;\n  playerB: Player;\n  question: string;\n  answer: string;\n  quizEndTime?: Date;\n}\n\ninterface Player {\n  userId: number;\n  ranking: number;\n  point: number;\n  winCnt: number;\n  profile: string;\n}\n\nconst socket = new SockJS(URL);\nconst stompClient = new Client({ webSocketFactory: () => socket });\n\nstompClient.activate();\n\nfunction MatchingGamePage() {\n  const [gameId, setGameId] = useState<number | null>(null);\n  const [imageUrl, setImageUrl] = useState(\"\"); // 이미지 URL 상태\n\n  const messageToSend: sendMessage = {\n    socketType: SocketType.GAME_INFO,\n    message: \"hihi\",\n  };\n\n  useEffect(() => {\n    // 컴포넌트가 마운트될 때, 웹 소켓을 사용할 준비\n    stompClient.activate();\n    console.log(\"axios 요청 호출\");\n    waitingGame()\n      .then((response) => {\n        console.log(response);\n        setGameId(response.data.data.gameId);\n        setImageUrl(serverUrl + \"/profiles/\" + response.data.data.profile);\n        console.log(\"url : \" + imageUrl);\n        console.log(response.data.data.profile);\n        console.log(`${serverUrl}/profiles/${response.data.data.profile}`);\n        // https://xn--vr-kg0j662g.site/profiles/2023/11/05/01c7b349-6bb2-4ae2-9d71-1b64370a280b-%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-08-25%20%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB%209.47.20.png\n        // 게임 아이디를 받아온 후, 웹 소켓을 초기화하고 구독합니다.\n        const subscription = subscribeToChatRoom(response.data.data.gameId);\n\n        return () => {\n          // 컴포넌트가 언마운트될 때 구독을 해제\n          subscription.unsubscribe();\n        };\n      })\n      .catch((error) => {\n        // 오류 처리\n      });\n\n    return () => {\n      // 컴포넌트가 언마운트될 때, 웹 소켓 연결 해제\n      stompClient.deactivate();\n    };\n  }, []);\n\n  return (\n    <div className=\"matching-game-container\">\n      {imageUrl && <img src={imageUrl} alt=\"Game Image\" />}\n\n      <div className=\"waiting-game-container\"></div>\n    </div>\n  );\n}\n\nfunction subscribeToChatRoom(gameId: number) {\n  return stompClient.subscribe(`/topic/game.${gameId}`, (message: Frame) => {\n    const receivedMessage: receiveMessage = JSON.parse(message.body);\n    console.log(\"Received message:\", receivedMessage);\n  });\n}\n\nfunction publishMessageToChatRoom(gameId: number, message: sendMessage) {\n  stompClient.publish({\n    destination: `/pub/game.${gameId}`,\n    body: JSON.stringify(message),\n  });\n}\n\nfunction MatchingGameStart() {\n  const [gameId, setGameId] = useState<number | null>(null);\n\n  const messageToSend: sendMessage = {\n    socketType: SocketType.GAME_INFO,\n    message: \"hihi\",\n  };\n\n  useEffect(() => {\n    // 컴포넌트가 마운트될 때, 웹 소켓을 사용할 준비\n    stompClient.activate();\n    console.log(\"axios 요청 호출\");\n    waitingGame()\n      .then((response) => {\n        console.log(response);\n        setGameId(response.data.data.gameId);\n\n        // 게임 아이디를 받아온 후, 웹 소켓을 초기화하고 구독합니다.\n        const subscription = subscribeToChatRoom(response.data.data.gameId);\n\n        return () => {\n          // 컴포넌트가 언마운트될 때 구독을 해제\n          subscription.unsubscribe();\n        };\n      })\n      .catch((error) => {\n        // 오류 처리\n      });\n\n    return () => {\n      // 컴포넌트가 언마운트될 때, 웹 소켓 연결 해제\n      stompClient.deactivate();\n    };\n  }, []);\n\n  return <div className=\"matching-game-container\"></div>;\n}\n\nexport { MatchingGamePage, MatchingGameStart };\n"],"mappings":";;;AAAA,OAAO,aAAa;AACpB,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACvB;AAC3B,SAASC,GAAG,EAAEC,SAAS,QAAkB,uBAAuB;AAChE,SAASC,MAAM,QAAe,gBAAgB;AAC9C,OAAOC,MAAM,MAAM,eAAe;AAElC,SACEC,UAAU,EACVC,WAAW,QACN,2CAA2C;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAgCnD,MAAMC,MAAM,GAAG,IAAIL,MAAM,CAACH,GAAG,CAAC;AAC9B,MAAMS,WAAW,GAAG,IAAIP,MAAM,CAAC;EAAEQ,gBAAgB,EAAEA,CAAA,KAAMF;AAAO,CAAC,CAAC;AAElEC,WAAW,CAACE,QAAQ,CAAC,CAAC;AAEtB,SAASC,gBAAgBA,CAAA,EAAG;EAAAC,EAAA;EAC1B,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGhB,QAAQ,CAAgB,IAAI,CAAC;EACzD,MAAM,CAACiB,QAAQ,EAAEC,WAAW,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;;EAE9C,MAAMmB,aAA0B,GAAG;IACjCC,UAAU,EAAEf,UAAU,CAACgB,SAAS;IAChCC,OAAO,EAAE;EACX,CAAC;EAEDvB,SAAS,CAAC,MAAM;IACd;IACAW,WAAW,CAACE,QAAQ,CAAC,CAAC;IACtBW,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;IAC1BlB,WAAW,CAAC,CAAC,CACVmB,IAAI,CAAEC,QAAQ,IAAK;MAClBH,OAAO,CAACC,GAAG,CAACE,QAAQ,CAAC;MACrBV,SAAS,CAACU,QAAQ,CAACC,IAAI,CAACA,IAAI,CAACZ,MAAM,CAAC;MACpCG,WAAW,CAAChB,SAAS,GAAG,YAAY,GAAGwB,QAAQ,CAACC,IAAI,CAACA,IAAI,CAACC,OAAO,CAAC;MAClEL,OAAO,CAACC,GAAG,CAAC,QAAQ,GAAGP,QAAQ,CAAC;MAChCM,OAAO,CAACC,GAAG,CAACE,QAAQ,CAACC,IAAI,CAACA,IAAI,CAACC,OAAO,CAAC;MACvCL,OAAO,CAACC,GAAG,CAAE,GAAEtB,SAAU,aAAYwB,QAAQ,CAACC,IAAI,CAACA,IAAI,CAACC,OAAQ,EAAC,CAAC;MAClE;MACA;MACA,MAAMC,YAAY,GAAGC,mBAAmB,CAACJ,QAAQ,CAACC,IAAI,CAACA,IAAI,CAACZ,MAAM,CAAC;MAEnE,OAAO,MAAM;QACX;QACAc,YAAY,CAACE,WAAW,CAAC,CAAC;MAC5B,CAAC;IACH,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,IAAK;MAChB;IAAA,CACD,CAAC;IAEJ,OAAO,MAAM;MACX;MACAvB,WAAW,CAACwB,UAAU,CAAC,CAAC;IAC1B,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,oBACE1B,OAAA;IAAK2B,SAAS,EAAC,yBAAyB;IAAAC,QAAA,GACrCnB,QAAQ,iBAAIT,OAAA;MAAK6B,GAAG,EAAEpB,QAAS;MAACqB,GAAG,EAAC;IAAY;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAEpDlC,OAAA;MAAK2B,SAAS,EAAC;IAAwB;MAAAI,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC3C,CAAC;AAEV;AAAC5B,EAAA,CA/CQD,gBAAgB;AAAA8B,EAAA,GAAhB9B,gBAAgB;AAiDzB,SAASiB,mBAAmBA,CAACf,MAAc,EAAE;EAC3C,OAAOL,WAAW,CAACkC,SAAS,CAAE,eAAc7B,MAAO,EAAC,EAAGO,OAAc,IAAK;IACxE,MAAMuB,eAA+B,GAAGC,IAAI,CAACC,KAAK,CAACzB,OAAO,CAAC0B,IAAI,CAAC;IAChEzB,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEqB,eAAe,CAAC;EACnD,CAAC,CAAC;AACJ;AAEA,SAASI,wBAAwBA,CAAClC,MAAc,EAAEO,OAAoB,EAAE;EACtEZ,WAAW,CAACwC,OAAO,CAAC;IAClBC,WAAW,EAAG,aAAYpC,MAAO,EAAC;IAClCiC,IAAI,EAAEF,IAAI,CAACM,SAAS,CAAC9B,OAAO;EAC9B,CAAC,CAAC;AACJ;AAEA,SAAS+B,iBAAiBA,CAAA,EAAG;EAAAC,GAAA;EAC3B,MAAM,CAACvC,MAAM,EAAEC,SAAS,CAAC,GAAGhB,QAAQ,CAAgB,IAAI,CAAC;EAEzD,MAAMmB,aAA0B,GAAG;IACjCC,UAAU,EAAEf,UAAU,CAACgB,SAAS;IAChCC,OAAO,EAAE;EACX,CAAC;EAEDvB,SAAS,CAAC,MAAM;IACd;IACAW,WAAW,CAACE,QAAQ,CAAC,CAAC;IACtBW,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;IAC1BlB,WAAW,CAAC,CAAC,CACVmB,IAAI,CAAEC,QAAQ,IAAK;MAClBH,OAAO,CAACC,GAAG,CAACE,QAAQ,CAAC;MACrBV,SAAS,CAACU,QAAQ,CAACC,IAAI,CAACA,IAAI,CAACZ,MAAM,CAAC;;MAEpC;MACA,MAAMc,YAAY,GAAGC,mBAAmB,CAACJ,QAAQ,CAACC,IAAI,CAACA,IAAI,CAACZ,MAAM,CAAC;MAEnE,OAAO,MAAM;QACX;QACAc,YAAY,CAACE,WAAW,CAAC,CAAC;MAC5B,CAAC;IACH,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,IAAK;MAChB;IAAA,CACD,CAAC;IAEJ,OAAO,MAAM;MACX;MACAvB,WAAW,CAACwB,UAAU,CAAC,CAAC;IAC1B,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,oBAAO1B,OAAA;IAAK2B,SAAS,EAAC;EAAyB;IAAAI,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAM,CAAC;AACxD;AAACY,GAAA,CApCQD,iBAAiB;AAAAE,GAAA,GAAjBF,iBAAiB;AAsC1B,SAASxC,gBAAgB,EAAEwC,iBAAiB;AAAG,IAAAV,EAAA,EAAAY,GAAA;AAAAC,YAAA,CAAAb,EAAA;AAAAa,YAAA,CAAAD,GAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}